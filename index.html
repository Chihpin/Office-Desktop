<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link href="./lib/holdon/HoldOn.min.css" rel="stylesheet">

    <style text="css">
      html, body {
        width: 100%;
        height: 100%;
        margin: 0 !important;
        padding: 0 !important;
      }
      #bar {
        width: 100%;
        line-height: 24px;
        background-color: rgba(60, 60, 60, 0.8);
        -webkit-app-region: drag;

        text-align: center;
        font-size: 13px;
        font-weight: 750;
        color: rgb(164, 164, 164);
        /* opacity: 0; */
        /* float: top; */
        z-index: -100;
      }
      /* #bar:hover {
        opacity: 1;
      }
      #bar:focus {
        opacity: 1;
      } */
      #web {
        /* margin-top: 24px; */
        background-color: rgb(28, 29, 29);
        border: none;
        width: 100%; 
        height: 676px; 
        /* position:absolute; */
        /* height: calc(100%-24px);  not working */ 
        display: inline-flex; 
      }
    </style>



    <script type="text/javascript">
      var $ = jQuery = require("./lib/jq.js")

      function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
      }

      $(document).ready(function() { 

          // loding
          const webview = document.querySelector('webview')
          const loadstart = () => {
            HoldOn.open({
              theme:"sk-rect",
              // backgroundColor: rgba(0, 0, 0, 0),
            });
          }
          const loadstop = () => {
            HoldOn.close()
          }
          webview.addEventListener('did-start-loading', loadstart)
          webview.addEventListener('did-stop-loading', loadstop)

          
          // set titie and url
          $('#title').text(getQueryString('title'))
          $('#web').attr('src', getQueryString('url'))


          // auto set webview fill window
          function autoHeight() { 
            var wHeight = $(window).height()-24;
            $('#web').height(wHeight + 'px');
          } 

          $(window).load(function() { 
              autoHeight()
          }); 

          $(window).resize(function() {
              autoHeight()
          });
      }); 
    </script>
  </head>


  <body style="overflow: hidden;">
    <div id="bar">
      <span id="title">Office</span>
    </div>
    <webview id="web"></webview>


    <script src="./lib/holdon/HoldOn.min.js"></script>
    <script>
      require('./renderer.js')
    </script>
  </body>
</html>
